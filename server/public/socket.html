<!DOCTYPE html>
<html lang="en">
    <head>
        <title>webSockets and Socket.IO</title>
        <script type="text/javascript" src="/socket.io/socket.io.js"></script>
        <!--The above library(/socket.io/socket.io.js) will be generated by socket.io module of server -->
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    </head>
    <style>
        table {
            table-layout: fixed;
            width: 1200px;
        }
      
    </style>
    <body>

            <table border="1" >  
                <tr>
                    <th>Timestamp</th>
                    <th>Type</th>
                    <th style="width: 40%;">Loadavg</th>
                    <th>Uptime</th>
                    <th>Freemem</th>
                    <th>Totalmem</th>
                </tr>
                <tr>
                    <td  id="timestamp"></td>   <!--This is where the data from the server is added--> 
                    <td  id="type"></td>
                    <td  id="loadavg"></td>
                    <td  id="uptime"></td>
                    <td  id="freemem"></td>
                    <td  id="totalmem"></td>
                </tr>

            </table> 
            

        <script type="text/javascript">
            var socket = io.connect('http://localhost:3000');
            /*Initializing the connection with the server via websockets */
            socket.on("update",function(message){

                /*
                    When server sends data to the client it will trigger "message" event on the client side , by
                    using socket.on("message") , one cna listen for the ,message event and associate a callback to
                    be executed . The Callback function gets the dat sent from the server
                */
                console.log("Message from the server arrived")

                console.log(message); /*converting the data into JS object */
                 
                var newMsg = jQuery.parseJSON(message);
                document.getElementById('timestamp').innerHTML = newMsg.timestamp;
                document.getElementById('type').innerHTML = newMsg.type;
                document.getElementById('loadavg').innerHTML = newMsg.loadavg;
                document.getElementById('uptime').innerHTML = newMsg.uptime;
                document.getElementById('freemem').innerHTML = newMsg.freemem;
                document.getElementById('totalmem').innerHTML = newMsg.totalmem;
            }); 

        </script>
    </body>
</html>
